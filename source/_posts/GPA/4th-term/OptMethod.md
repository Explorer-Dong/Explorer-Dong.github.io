---
title: OptMethod
categories:
  - GPA
  - 4th-term
category_bar: true
---


# 最优化方法

## 前言

学科地位：

| 主讲教师 | 学分配额 | 学科类别 |
| :------: | :------: | :------: |
|  王启春  |    4     |  专业课  |

成绩组成：

| 平时 | 期中（大作业） | 期末 |
| :--: | :------------: | :--: |
| 20%  |      30%       | 50%  |

教材情况：

|  课程名称  |  选用教材  | 版次 |  作者  |     出版社     |      ISBN号       |
| :--------: | :--------: | :--: | :----: | :------------: | :---------------: |
| 最优化算法 | 最优化方法 |  2   | 孙文瑜 | 高等教育出版社 | 978-7-04-029763-8 |

## 第一章 基本概念

### 1.1 最优化问题简介

本目主要讲解最优化问题的一些分类，下附脑图（由 Xmind 软件制作）：

{% fold info @分类脑图 %}
![分类脑图](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403091214182.png)
{% endfold %}

### 1.2 凸集和凸函数

由于本书介绍的最优化求解方法一般只适用于求解**局部最优解**，那么如何确定**全局最优解**呢？以及如何确定**唯一的全局最优解**呢？本目揭晓答案：$局部最优解+(严格)凸目标函数+凸可行域=(唯一)全局最优解$

#### 1.2.1 凸集

**凸集的定义**
$$
\forall \quad x,y \in D \ \land \ \lambda \in [0,1] \\
s.t. \quad \lambda x+(1-\lambda)y \in D \\
\text{则称} D \text{为凸集}
$$
**凸集的性质**：设 $D_1,D_2 \subset R^n$ 均为凸集（下列 $x,y$ 均表示向量），则：

1. 两凸集的交 $D_1 \cap D_2 = \{x\ |\ x \in D_1 \land x \in D_2\}$ 是凸集
2. 两凸集的和 $D_1 + D_2 = \{x,y\ |\ x \in D_1 , y \in D_2\}$ 是凸集
3. 两凸集的差 $D_1 - D_2 = \{x,y\ |\ x \in D_1 , y \in D_2\}$ 是凸集
4. 对于任意非零实数 $\alpha$，集合 $\alpha D_1 = \{ \alpha x \ |\ x \in D_1 \}$​ 是凸集

{% fold info @凸集的性质证明 %}
![凸集的性质证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403101941905.png)
{% endfold %}

**凸集的应用**

1. 刻画可行域
    - 凸组合定义
        $$
        设\ x^{(1)},x^{(2)}, \cdots, x^{(p)} \in R^n ,且\ \sum_{i=1}^p \alpha_i = 1(a_i \ge 0)  \\
        s.t. \quad x = \alpha_1x^1 + \alpha_2x^2 + \cdots + \alpha_px^p  \\
        则称\ x\ 为向量\ x^{(1)},x^{(2)}, \cdots, x^{(p)}\ 的凸组合
        $$
    
    - 凸组合定理：$D \in R^n$ 是凸集的充分必要条件是 $D$ 中任取 $m$ 个点 $x^i(1,2,\cdots m)$ 的凸组合任属于 $D$，即：
        $$
        \sum_{i=1}^m \alpha_ix_i \in D\left( \alpha_i \ge 0(i=1,2,\cdots,m),\sum_{i=1}^m \alpha_i = 1 \right)
        $$
    
      {% fold info @凸组合定理证明 %}
      ![凸组合定理证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403102025159.png)
      {% endfold %}

    
2. 分析最优解的最优性条件
    - 超平面定义（凸集分离定理）：设 $D_1,D_2 \subset R^n$ 为两非空凸集，若存在非零向量 $\alpha \in R^n$ 和实数 $\beta$，使得
        $$
        D_1 \subset H^+ = \{ x \in R^n \ | \ \alpha^T x \ge \beta\} \\
        D_2 \subset H^- = \{ x \in R^n \ | \ \alpha^T x \le \beta\}
        $$
        则称超平面 $H = \{ x \in R^n \ | \ \alpha^Tx=\beta \}$ **分离**集合 $D_1$ 和 $D_2$，**严格分离**时上述不等式无法取等
    
    - 投影定理：设 $D \in R^n$ 是非空闭凸集，$y \in R^n$ 但 $y \notin D$，则
        $$
        \begin{align*}
            (1)& 存在唯一的点 \ \overline x \in D,使得集合D到点 y 的距离最小 \\
            (2)& \overline x \in D 是点 y 到 集合D的最短距离点的充分必要条件为:\forall x \in D,<x-\overline x,y - \overline x> \le 0
        \end{align*}
        $$

#### 1.2.2 凸函数

凸函数的定义：设函数 $f(x)$ 在凸集 $D$ 上有定义

- 若 $\forall x,y \in D\ 和\ \lambda \in [0,1]$ 有 $f(\lambda x + (1-\lambda)y) \le \lambda f(x) + (1-\lambda)f(y)$，则称 $f(x)$ 是凸集 $D$ 上的凸函数
- 若 $\forall x,y \in D\ 和\ \lambda \in (0,1)$ 有 $f(\lambda x + (1-\lambda)y) < \lambda f(x) + (1-\lambda)f(y)$，则称 $f(x)$ 是凸集 $D$ 上的严格凸函数

凸函数的性质：

1. 如果 $f$ 是定义在凸集 $D$ 上的凸函数，实数 $\alpha \ge 0$，则 $\alpha f$ 也是凸集 $D$ 上的凸函数
2. 如果 $f_1,f_2$ 是定义在凸集 $D$ 上的凸函数，则 $f_1+f_2$ 也是凸集 $D$ 上的凸函数
3. 如果 $f_i(x)(i=1,2,\cdots,m)$ 是非空凸集 $D$ 上的凸函数，则 $f(x) = \max_{1 \le i \le m} |f_i(x)|$ 也是凸集 $D$ 上的凸函数
4. 如果 $f_i(x)(i=1,2,\cdots,m)$ 是非空凸集 $D$ 上的凸函数，则 $f(x) = \displaystyle \sum_{i=1}^m \alpha_i f_i(x)\quad(\alpha_i \ge 0)$ 也是凸集 $D$​ 上的凸函数

{% fold info @凸函数的性质证明（第3条待定） %}
![第1、2条](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403112030190.png)
![第4条](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403112030160.png)
{% endfold %}

凸函数的判别定理：

1. 函数值角度：函数 $f(x)$ 是 $R^n$ 上的凸函数的充分必要条件是 $\forall x,y \in R^n$，单变量函数 $\phi(\alpha)=f(x + \alpha y)$ 是关于 $\alpha$ 的凸函数

    {% fold info @凸函数的判别定理证明：函数值角度 %}
    ![凸函数的判别定理证明 - 函数值角度](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403131019868.png)
    {% endfold %}

2. 一阶导数角度：设 $f(x)$ 是定义在非空开凸集 $D$ 上的可微函数，则

    - $f(x)$ 是 $D$ 上凸函数的充分必要条件是 $f(y) \ge f(x)+\nabla f(x)^T(y-x)$
    - $f(x)$ 是 $D$ 上严格凸函数的充分必要条件是 $f(y) > f(x)+\nabla f(x)^T(y-x)$

    {% fold info @凸函数的判别定理证明：一阶导数角度 %}
    无需掌握证明，但是为了便于理解性记忆，可以从**二次凸函数**进行辅助理解记忆。
    ![凸函数的判别定理证明 - 一阶导数角度](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403131018032.png)
    {% endfold %}

3. 二阶导数角度：略

#### 1.2.3 凸规划（个人补充）

本目为个人补充内容，用于整合上述 1.2.1 与 1.2.2 内容。我们知道，学习凸集和凸函数的终极目标是为了求解凸规划问题，凸规划问题可以简述为**凸可行域+凸目标函数+局部最优解=全局最优解**，那么如何证明这个定理是正确的呢？局部最优解求出来以后，目标函数也确定为凸函数以后，如何确定可行域是凸集呢？下面揭晓：

**证明凸规划问题的正确性**

1. 定理：在可行域是凸集，目标函数非严格凸的情况下，局部最优解 $x^*$​ 也是全局最优解

    {% fold info @证明（反证法） %}
    ![证明（反证法）](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403122016285.png)
    {% endfold %}

2. 定理：在可行域是凸集，目标函数是严格凸的情况下，局部最优解 $x^*$ 也是唯一的全局最优解

    {% fold info @证明（反证法） %}
    ![证明（反证法）](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403122017101.png)
    {% endfold %}

**确定可行域是否为凸集**

1. 定理：若约束条件 $c_i(x) \ge 0$ 中每一个约束函数 $c_i(x)$ 都是凹函数，则可行域 $F$ 是凸集

    {% fold info @证明 %}
    ![证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403122019899.png)
    {% endfold %}

2. 定理：若约束条件 $c_i(x) \le 0$ 中每一个约束函数 $c_i(x)$ 都是凸函数，则可行域 $F$ 是凸集

    {% fold info @证明 %}
    ![证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403122019572.png)
    {% endfold %}

3. 定理：若约束条件中每一个约束函数 $c_i(x)$ 都恒等于零，则可行域 $F$ 是凸集

    {% fold info @证明 %}
    ![证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403122019751.png)
    {% endfold %}

### 1.3 最优性条件

最优性条件是指最优化问题的最优解所必须满足的条件，本目只介绍**无约束最优化**的**一阶必要条件**。

- **下降方向**定义：设 $f(x)$ 为定义在空间 $R^n$ 的连续函数，点 $\bar x \in R^n$，若对于方向 $s \in R^n$ 存在数 $\delta >$ 0 使
    $$
    f(\bar x+\alpha s) < f(\bar x),\quad \forall \alpha \in (0,\delta)
    $$
    成立，则称 $s$ 为 $f(x)$ 在 $\bar x$ 处的一个下降方向。在 点 $\bar x$ 处的所有下降方向的全体记为 $D(\bar x)$

- **下降方向**定理：设函数 $f(x)$ 在点 $\bar x$ 处连续可微，如存在非零向量 $s  \in R^n$ 使
    $$
    \nabla f(\bar x)^Ts < 0
    $$
    成立，则 $s$ 是 $f(x)$ 在点 $\bar x$ 处的一个下降方向

    {% fold info @证明 %}
    ![证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403131639082.jpg)
    {% endfold %}

- **一阶必要条件**定理：设 $f:D \subset R^n \to R^1$ 在开集 $D$ 上连续可微，若 $x^* \in D$ 是目标函数的局部极小点，$f(x)$ 的一阶导数 $\nabla f(x)$ 表示为 $g(x)$，则
    $$
    g(x^*)=0
    $$

### 1.4 最优化方法概述

现实生活中，对于常见问题的建模往往是极其复杂的，为了求得最优解，我们需要对建立的模型进行微分算子的求解。但是问题是，尽管我们知道最优解一定存在于微分算子的数值解中，但是我们往往不能很快的计算出其数值解，因此我们需要采用别的方法进行计算。最常用的方法就是本书介绍的迭代法。

大概就两步：确定初值开始判断，如果符合条件的约束则停止迭代得到最终的解；如果不符合约束则对当前迭代值赋予修正量并继续迭代判断。直到找到最终的解。接下来将对 5 个专有名词进行解释，分别为：初始点的选取、迭代点好坏的判定、收敛速度、迭代的终止条件、修正量 $s^{(k)}$ 的确定

#### 1.4.1 初始点的选取

初始点的选取取决于算法的收敛性能。

- 如果一个算法可以做到全局收敛，则初始点的选取是任意的
- 如果一个算法只能局部收敛，则初始点的选取往往需要尽可能的接近最优解，而这往往是困难的，因为我们并不知道的最优解是什么。此时可以采用借鉴之前的经验来选择初始点

#### 1.4.2 迭代点好坏的判定

判定一个迭代点的好坏时，我们往往会设计一个评价函数，而评价函数的设计取决于约束问题的种类。

- 对于无约束最优化问题。我们可以直接将目标函数 $f(x)$ 设计为评价函数。很显然，如果一个迭代点对应的的函数值比之前点对应的函数值更小，则可以说明当前迭代点由于之前的点
- 对于有约束最优化问题。此时我们不仅仅需要考虑函数值的大小，也要考虑当前迭代点的可行程度（离可行域的距离）。因此此类最优化问题往往既包含目标函数，也包含约束函数。

#### 1.4.3 收敛速度

若当前算法一定收敛，我们还需要判断收敛的速度，接下来介绍收敛的速度。

假设

- 设向量序列 $\{ x^{(k)} \subset R^n \}$ 收敛于 $x^*$​

定义

1. 误差序列：$e_k = x^{(k)} - x^*$
2. 收敛率表达式：$\displaystyle \lim_{k \to \infty} \frac{|| e_{k+1} ||}{||e_k||^r} = C$，并称序列 $\{x^{(k)}\}$ 的 $r$ 阶以 $C$ 为因子收敛于 $x^*$

线性收敛

- 定义：$r=1,0 < C<1$
- 性质：$C$ 越小，算法收敛越快

超线性收敛

- 定义：$r=1,C=0$

- 定理：$r>1$​ 时的算法均为超线性收敛算法

    {% fold info @证明 %}
    ![证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403201331819.png)
    {% endfold %}

#### 1.4.4 迭代的终止条件

- 对于收敛速度比较慢的算法：

    根据一阶必要条件，我们知道最优解一定取在微分算子为 0 的向量上，因此我们以下式为终止条件是一种可行的选择
    $$
    ||\nabla f(x^{(k)}|| \le \epsilon
    $$
    但是问题在于这对收敛速度很快的算法不使用，如下图的无约束最优化问题。已知两个局部最优解分别为 $x_1^*,x_2^*$，迭代的两个解分别为 $\overline{x}_1,\overline{x}_2$，可以看出：尽管 2 号点相对于 1 号点更靠近局部最优解，但是由于 2 号点的梯度更大，明显不如 1 号点更加局部最优，因此利用微分算子作为迭代的终止条件不适用于收敛速度快的算法

    ![无约束最优化问题](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403201330908.png)

- 对于超线性收敛的算法：

    一个理想的收敛终止条件为 $||x^{(k)} - x^*|| \le \epsilon$，但是由于最优解 $x^*$ 是未知的，因此该方案不可行，同理 $f(x^*)$ 也是未知的，因此 $||f(x^{(k)}) - f(x^*)|| \le \epsilon$ 也是不可行的。那么有没有什么替代的方案呢？答案是有的。

    1. 方案一：利用**函数解序列**进行替代。即以下式作为迭代的终止条件
        $$
        || x^{(k+1)} - x^{(k)} || \le \epsilon
        $$

        {% fold info @证明 %}
        ![证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403201425856.jpg)
        {% endfold %}

    2. 方案二：利用**函数值序列**进行替代。即以下式作为迭代的终止条件
        $$
        || f(x^{(k+1)}) - f(x^{(k)}) || \le \epsilon
        $$

        {% fold info @证明 %}
        ![证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403201425473.jpg)
        {% endfold %}

- 一般情况下，对于上述超线性算法的判断收敛的方法，只用其中一种往往不适当。此时一般使用两种方法集成的思路进行判断。

#### 1.4.5 修正量的确定

本书介绍的迭代修正值都是使得当前迭代后的值小于上一个状态的函数值，我们称这类使评价函数值下降的算法为**单调下降算法**。至于如何得出修正量，我们往往通过求解一个相对简单易于求解的最优化问题（通常成为子问题），来计算获得修正量。

## 第二章 线性规划

### 2.1 线性规划问题和基本性质

#### 2.1.1 线性规划问题

{% fold info @线性规划问题的一般形式 %}
![线性规划问题的一般形式](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403211918859.png)
{% endfold %}

#### 2.1.2 图解法

**仅适用于二元变量**的线性规划问题。我们将所有的约束条件全部画到平面直角坐标系中构成一个可行域，然后将目标函数作为一条直线进行平移，直到与可行域初次有交点，则该交点就是最优解对应的点。当然不一定会有交点，一共分为四种情况：

{% fold info @刚好只有一个最优解 %}
![刚好只有一个最优解](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403211917063.png)
{% endfold %}

{% fold info @有无穷多最优解 %}
![有无穷多最优解](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403211920849.png)
{% endfold %}

{% fold info @有无界解 %}
![有无界解](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403211921495.png)
{% endfold %}

{% fold info @无可行解 - 可行域为空集 %}
![无可行解 - 可行域为空集](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403211922747.png)
{% endfold %}

#### 2.1.3 基本性质

1. 线性规划问题的可行域如果非空，则是一个凸集

    {% fold info @证明 %}
    ![证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403212109584.jpg)
    {% endfold %}

2. 如果线性规划问题有最优解，那么最优解可在可行域的顶点中确定

3. 如果可行域有界且可行域只有有限个顶点，则问题的最优解必存在，并在这有限个顶点中确定

4. 最优解可由最优顶点处的**有效约束**形成的方程组的解确定

#### 2.1.4 线性规划的标准形 :star:

为什么要学习线性规划的标准形？

- 我们要学习单纯形法来计算多维线性规划的最优解
- 单纯形法需要线性规划的具有所谓的标准形

线性规划的标准形的定义：

- 只含有线性等式约束和对变量的非负约束

一般线性规划转化为标准形的方法：

1. 对于目标函数：需要将取 $\max$ 通过**取相反数**转化为取 $\min$
2. 对于约束条件：需要将不等式约束**松弛**转化为等式约束
    - 对于 $\le$ 的不等式约束，等式左边加上非负新变量，从而转化为等式
    - 对于 $\ge$ 的不等式约数，等式左边减去非负新变量，从而转化为等式
3. 对于无约束的变量：需要将其转化为**两个新变量之差**（可正可负），产生了一个新的等式，如果该无约束变量存在于目标函数中，还需要将目标函数中的该变量表示为两个新变量之差

{% fold info @举个例子 %}
![一般线性规划转化为标准形 - 演示](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403212111330.jpg)
{% endfold %}

#### 2.1.5 基本可行解

直接说结论：对于标准形的线性规划问题，其基本可行解就是凸集的顶点。

假设系数矩阵 $A_{m, n}$。基本可行解 $\subset$ 基本解，而基本解的个数 $\le C_{n}^{m}$（因为分块矩阵 $B_{m \times m}$ 不一定可逆）。其中基本可行解需要满足解序列元素非负。如果序列含有 0 元素，称其为退化的基本可行解，产生退化的基本可行解的原因是存在可删除的约数条件。

#### 2.1.6 最优解的性质

- 若可行域有界，则线性规划问题的目标函数一定可以在其可行域的顶点上达到最优。

    {% fold info @证明 - 反证法 %}
    ![证明](https://dwj-oss.oss-cn-nanjing.aliyuncs.com/images/202403222103333.jpg)
    {% endfold %}

- 有时，目标函数可能在多个顶点处达到最大，这时在这些顶点的**凸组合**上也达到最大值，这时线性规划问题有无限多个最优解。

### 2.2 单纯形法



## 第三章 线性搜索与信赖域方法
